# 匿名性分析

比特币中不要求用真名，可以用公钥产生的地址，所以比特币具有一定的匿名性。也就是你可以产生任意多的地址，然后用不同的地址干不同的事情。它用的是化名，但它不是完全没有名字，所以有人把它称为 preudonymity。

**比特币和银行存款哪个匿名性更好?**

银行账户是实名制，你得提交身份信息，然后才能注册银行账户，而比特币不需要，从这点上看比特币匿名性要好。其实，以前银行是可以用化名的，如果银行账户匿名的话隐私性和匿名性与比特币相比哪个好?

答案是银行账户更好。==比特币区块链的账本是公开的，所有人都能查到==，每个人都可以上区块链把整个信息下载下来。而银行的账本是受控制的，银行的工作人员可以查到，一些司法手段也可以调取银行的信息，但普通百姓是查不到别人的账的。

## BTC系统中什么情况会破坏其匿名性？

1. 用户可以生成多个地址账户，但这些地址账户可以被关联起来

   有的人推荐每次收款都用一个新的地址，这样的话可以有不同的地址，谁也不知道哪些是属于你的，看起来好像匿名性很强，但实际上这些地址是可以被关联在一起的。

   比如网上购物，比特币交易允许有多个输入多个输出。而==多个输入有可能是同一个人，因为这个人可能同时控制了这两个账户的私钥==。==有多个输出，很可能有一个是找零钱的地址，这种交易一般都是比特币钱包软件生成的。很多交易软件每次交易的时候都会生成一个新的找零的地址，也是为了隐私保护。==

   有没有可能把输入地址和输出地址也关联起来呢？比特币生成交易的时候并没有规定找零钱的地址在 outputs 中出现的位置，所以想知道哪个是找零的地址也并不容易，但有些情况下可以分析出来。

   ![图片说明](https://littleneko.oss-cn-beijing.aliyuncs.com/img/3388381_1582334259941_F16AC02F874F4650B031987F01A1212B)

   如上图，针对该交易，账户上面数字表示 BTC，可以知道 addr4 很明显是找零钱的地址，而非 addr3(支付 6 个比特币，单个账户不够用，所以用两个账户)。

2. 地址账户与个人在真实社会中的身份也可能会产生关联

   任何使得 BTC 和实体世界中关联的操作都有可能泄露用户真实身份，其中最明显的就是资金的转入转出。要得到 BTC，如果用钱买，就会与实体世界进行交互。想要将 BTC 转为现实中的货币，也同样需要与实体世界交互。

3. BTC 支付时候

   例如某些商家接受用 BTC 进行支付，在进行支付时候，便和个人账户建立了联系，从而会泄露掉个人信息。

也就是说，BTC 并不是具有很好的匿名信。实际中，很多人保持有较好的匿名性。保持最好的便是其开发者中本聪，其参与 BTC 时间最长，全世界都想知道他是谁。但实际上，中本聪的比特币并非有花出去，这也使得我们难以发现他具体是谁。

## BTC匿名性有多好？如何提高匿名性？

匿名的本质是不想要暴露身份。而对于普通人来说，BTC 的现有机制已经足够保持个人隐私了。但如果涉及违法，行政机关想要获得真实身份，其实很容易。
那么可以采取哪些方法尽可能提高匿名性？

1. 网络层怎么提高匿名性？

   从网络层看，可以采用多路径转发的方法，数据不直接发送出去，而是经过很多跳 (洋葱路由的基本思想)。

2. 应用层怎么提高匿名性?

   从应用层看，可以将各个不同用户的 BTC 混合在一起，使得追查变得混乱 (Coin mixing)；



实际上，暴露用户隐私正是由于区块链的公开性和不可篡改性。不可篡改性对于隐私保护，实际上是灾难性的。

# 零知识证明

**零知识证明：一方（证明者）向另一方（验证者）证明某一个陈述是正确的，但不需要透露除该陈述是正确的之外的任何信息**。

例如：A 想要向 B 证明某一账户属于 A，这说明 A 知道该账户的私钥。但不可能通过 A 公布私钥的方法来证明，该账户确实属于 A。因此，A 可以产生一个账户签名，B 通过公钥对签名进行验证。(实际上该证明是否属于零知识证明存在争议，因为泄露了用私钥产生的签名)

<img src="https://littleneko.oss-cn-beijing.aliyuncs.com/img/image-20221024222602989.png" alt="image-20221024222602989" style="zoom:33%;" />

零知识证明的数学基础便是同态隐藏。上图为同态隐藏的三个性质。

* 第一个性质，说明如果有 E(X)=E(y)，则必然有 x=y。(无碰撞)
* 第二个性质，说明加密函数不可逆。知道加密值，无法反推出密码值。
* 第三个性质，最为重要，称为同态运算。说明对加密后的函数值进行某些代数运算，等价于对输入直接进行代数运算再加密。



**例子**：Alice 想要向 Bob 证明她知道一组数 𝑥 和 𝑦 使得 𝑥 + 𝑦 = 7，同时不让 Bob 知道 𝑥 和 𝑦 的具体数值。

**简单版本**：

1. Alice 把 𝐸(𝑥) 和 𝐸(𝑦) 的数值发给 Bob
2. Bob 通过收到的 𝐸(𝑥) 和 𝐸(𝑦) 计算出 𝐸(𝑥 + 𝑦) 的值（利用了性质 3）
3. Bob 同时计算 𝐸(7) 的值，如果 𝐸(𝑥 + 𝑦) = 𝐸(7)，那么验证通过，否则验证失败。

**缺陷**：Bob 可以用蛮力算法，一个一个试而计算出 x 和 y 的值，因此 Alice 要对 x 和 y 的值做一些随机化处理，保证 x 和 y 加起来还是不变的。



不考虑去中心化的前提下，前面在讲 double spending 时讲过，要对每一个数字货币进行编号就能防止 double spending。回到这节课讲的隐私保护问题，央行是什么都知道的，那么有没有什么办法让央行做中心化的记账检测 double spending，又不让它知道？即虚拟货币的编号不能是央行产生的，改成自己产生的，又不会被篡改掉。

这里就要用到盲签方法：

<img src="https://littleneko.oss-cn-beijing.aliyuncs.com/img/image-20221024224615429.png" alt="image-20221024224615429" style="zoom:33%;" />

## 零币和零钞——专门为匿名性设计的货币

既然了解到 BTC 提供了较好匿名性，但其无法完全消除关联性，那么如果想要这样一种货币怎么办？这就涉及了零币和零钞。

<img src="https://littleneko.oss-cn-beijing.aliyuncs.com/img/image-20221024224955386.png" alt="image-20221024224955386" style="zoom: 33%;" />

零币在花费的时候，只需要用零知识证明来证明所花掉的币是系统中存在的某一个合法的币，但不用透露具体花掉的是系统中哪一个币。这样就破坏了关联性。
当然，这类货币并非主流加密货币，因为其为了设计匿名性，付出了一定代价，而且，需要强匿名性的用户并不多。

从数学上看，零币和零钞是安全的。但其并不是百分之百的匿名，其并未解决与系统外部实体发生交互时对匿名性的破坏。



https://blog.nowcoder.net/n/30cbdb37108b4d93b3a5a93b8226ae31